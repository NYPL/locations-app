<div class="grid__item content one-whole all-locations">

  <form class="form--locinator grid__item one-whole lap-and-up-one-half hard--left text--center">
    <span class="icon-search"></span>
    <input class="searchbox--locinator" id="searchTerm" type="text" data-ng-model="searchTerm"/>
    <a href="" id="clearsearch" class="icon-cancel-circle" data-ng-click="clearSearch()"></a>
    <label for="searchTerm">Ex. Jefferson Market, 10018, 455 Fifth Avenue</label>
    <button id="findit" class="btn--small alpha" data-ng-click="submitAddress(searchTerm)">{{ 'MAIN_SEARCH_BTN' | translate }}</button>

    <div class="filters" data-ng-if="locations">
	    <div class="filters__current" data-ng-if="geolocationOn">{{ 'SEARCH_NEAR' | translate }}
        <a id="currentloc" class="btn btn--natural" href="" data-ng-click="useGeolocation()">{{ 'USER_LOCATION' | translate }}</a>
      </div>
	    <div class="filters__research">{{ 'RESEARCH_TEXT' | translate}}
        <a id="onlyresearch" class="btn btn--natural" data-ng-class="{false: '', true: ''}[researchBranches]" href="" data-ng-click="showResearch()">{{researchBranches && 'ALL_LOCATIONS' || 'RESEARCH_LOCATIONS' | translate}}</a>
      </div>
      <!-- <div class="filters__">Show me <a class="btn btn--natural" href="" data-ng-click="allBranchesInit()">all branches</a></div> -->
    </div>
    
  </form><!--

  --><div id="all-locations-map" class="grid__item one-whole lap-and-up-one-half nypl-map"></div>
  <div id="all-locations-map-legend" class="hide-legend">
    <span data-ng-if="locations"><img src="http://maps.google.com/mapfiles/ms/icons/red-dot.png" />
      {{ 'NYPL_MARKER' | translate }}<br /></span>
    <span data-ng-if="locationStart"><img src="http://maps.google.com/mapfiles/ms/icons/blue-dot.png" />
      {{ 'USER_MARKER' | translate }}</span>
  </div>

  <section class="list">
 
    <div class="search_result_text grid__item one-half">
      <div id="distanceerror" data-ng-if="distanceError">{{distanceError}} {{ 'STILL_SEARCH_DIRECTIONS' | translate }}</div>
      <div id="searchError" data-ng-if="searchError">{{ 'NO_RESULTS' | translate }} <strong>{{searchError}}</strong> {{ 'WITHIN_25_MILES' | translate }}</div>
      <!-- <div id="filteredresults" data-ng-if="filteredResults">Found {{filteredResults}}</div> -->
      <div id="resultsnear" class="alpha" data-ng-if="geolocationAddressOrSearchQuery">{{ 'SHOWING_RESULTS_NEAR' | translate }} <a href="">{{geolocationAddressOrSearchQuery}}</a></div>
    </div>
  	
    <br />

    <section class="results--heds grid one-whole push-half--left epsilon orangeDarkerText">
      <div id="nameSorter" class="grid__item one-quarter location-sorter" ng-click="predicate = 'name'; reverse=!reverse">
        {{ 'LOCATION_HEADER' | translate }}
      </div><!--

      --><div id="distanceSorter" class="grid__item one-quarter" data-ng-class="{false: '', true: 'location-sorter'}[predicate=='distance']" ng-click="distanceSort()">
        {{ 'DISTANCE_HEADER' | translate }}
      </div><!--

      --><div class="grid__item one-quarter">{{ 'HOURS_HEADER' | translate }}</div><!--

    --><div class="grid__item one-quarter">{{ 'SERVICES_HEADER' | translate }}</div>
    </section>

    <!-- Locations are in h-card microformat -->
    <!-- http://microformats.org/wiki/h-card -->

    <section class="grid one-whole location push-half--left {{location._id}} {{location.highlight}}" 
      data-ng-repeat="location in locations | filter:{type:location_type} | orderBy:predicate:reverse | limitTo: libraryLimit">

      <div class="results--location h-card grid__item one-half lap-and-up-one-quarter">
        <div class="p-org beta"><a href='/#/{{location.slug}}'>{{location.name}}</a></div>
        <div class="p-adr">
          <div class="p-street-address">{{location.street_address}}</div>
          <span class="p-locality">{{location.locality}}</span>, 
          <span class="p-region">{{location.region}}</span>, 
          <span class="p-postal-code">{{location.postal_code}}</span>
        </div>
        <div class="p-tel" data-ng-if="location.contacts.phone">Phone: {{location.contacts.phone}}</div>
      </div><!--

      --><div class="results--more grid__item one-half lap-and-up-three-quarters hard--left">
        
        <div class="results--distance grid__item one-whole lap-and-up-one-third">
          <div class="distance" data-ng-if="location.distance"><strong>{{location.distance}} {{ 'MILES' | translate}}</strong></div>
          <div><a class="icon-map" href="/#/{{location.slug}}/map">{{ 'VIEW_MAP' | translate}}</a></div>
          <div>
            <a class="icon-compass" href="https://maps.google.com/maps?saddr={{locationStart}}&daddr={{location.locationDest}}">{{ 'DIRECTIONS' | translate }}</a>
          </div>
        </div><!--

        --><div class="results--hours h-card grid__item one-whole lap-and-up-one-third">
            {{ location.hoursToday(location.hours) | timeFormat }}
        </div><!-- 

        --><div class="results--services h-card grid__item one-whole lap-and-up-one-third">
          <ul>
            <li data-ng-repeat="service in location._embedded.services | limitTo:3">
              {{service.name}}
            </li>
          </ul>
        </div>
      </div>
    </section> 
    <!-- End of ng-repeat -->

    <section class="grid one-whole" data-ng-if='locations'>
      <div id="showing" class="grid--center grid__item">{{ 'SHOWING' | translate }} {{locationsListed}} {{ 'OF' | translate }} {{totalLocations}} {{ 'LOCATIONS' | translate }}</div>
      <div class="grid--center grid__item" data-ng-if="showMore">
        <a href="" id="showmore" class="btn" data-ng-click="viewMore()">Show {{increaseBy}}</a>
      </div>
    </section>

  </section>
</div>
